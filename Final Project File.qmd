---
title: "Final Project"
format: html
editor: visual
---

## Project

```{r}

library(tidyverse)
library(ggplot2)
library(gganimate)

rawdata <- read_csv("data/pollution.csv")

filtered <- rawdata |>
  filter(Dim2ValueCode == "GHECAUSE_GHE000000", Dim1ValueCode != "SEX_BTSX")
colnames(filtered)[13] <- "Gender"

continent <- filtered |>
  group_by(ParentLocation, Period, Gender) |>
  mutate(deaths = mean(FactValueNumeric))

filtered <- filtered |>
  group_by(Location, Period) |>
  mutate(deaths = mean(FactValueNumeric))

continent <- continent |>
  group_by(ParentLocation, Period) |>
  arrange(desc(ParentLocation)) |>
  group_by(ParentLocation, Period, Gender) |>
  slice(1)

continent
  
```

Research Question: 

```{r}

airq = airquality
airq$Month = month.name[airq$Month]

ggplot(
  airq, 
  aes(Day, Temp, group = Month)
) + 
  geom_line() + 
  geom_segment(
    aes(xend = 31, yend = Temp), 
    linetype = 2, 
    colour = 'grey'
  ) + 
  geom_point(size = 2) + 
  geom_text(
    aes(x = 31.1, label = Month), 
    hjust = 0
  ) + 
  gganimate::transition_reveal(Day) +
  coord_cartesian(clip = 'off') + 
  labs(
    title = 'Temperature in New York', 
    y = 'Temperature (Â°F)'
  ) + 
  theme_minimal() + 
  theme(plot.margin = margin(5.5, 40, 5.5, 5.5))

```


```{r}

ggplot(data = continent, aes(x = ParentLocation, y = deaths)) +
  geom_bar(stat = "identity") +
  # Here comes the gganimate code
  transition_states(
    Period,
    transition_length = 2,
    state_length = 1
  ) +
  enter_fade() +
  exit_shrink() +
  labs(title = 'Year: {closest_state}', x = 'Continent', y = 'Average deaths') +
  ease_aes('sine-in-out') 

```


```{r}

africa <- continent |>
  group_by(ParentLocation, Period) |>
  arrange(desc(ParentLocation)) |>
  group_by(ParentLocation, Period, Gender) |>
  slice(1)

```